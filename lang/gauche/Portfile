# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id: Portfile 82967 2011-08-22 20:48:02Z snc@macports.org $

PortSystem 1.0

name                gauche
version             0.9.1
revision            0
categories          lang scheme
maintainers         akitada openmaintainer
description         A script interpreter based on Scheme
long_description    Gauche is a script interpreter based on Scheme.  \
                    Gauche conforms the language standard 'Revised^5 \
                    Report on the Algorithmic Language Scheme' and \
                    supports various common libraries defined in SRFIs. \
                    The goal of Gauche is to provide a handy tool for \
                    programmers and system administrators to handle \
                    daily works conveniently and efficiently in the \
                    production environment.\
                    There are lots of Scheme implementations available, \
                    and each of them has its design emphasis and \
                    weeknesses.  Gauche is designed with emphasis on \
                    Quick startup, Multibyte strings, Modular \
                    development, Integrated object system, System \
                    interface and Enhanced I/O.
platforms           darwin
homepage            http://www.shiro.dreamhost.com/scheme/gauche/
master_sites        sourceforge
distname            Gauche-${version}
distfiles           ${distname}.tgz
checksums           md5 6134e9c16aef2bc9fd3fa7e8fbebdd10 \
                    sha1 0581b16ffe77fc836c8b56faae0c9820490b17c8 \
                    rmd160 a51fbd1751c5925aff8f1f0644ab4247c28bd9a5

depends_lib         port:gdbm \
                    port:libiconv \
                    port:slib

if {${configure.compiler} == "clang" ||
	${configure.compiler} == "llvm-gcc-4.2"} {
	configure.compiler gcc-4.2
	if {![file executable ${configure.cc}]} {
		depends_build-append port:apple-gcc42
		configure.compiler apple-gcc-4.2
	}
}

configure.args      --mandir=${prefix}/share/man --infodir=${prefix}/share/info \
                    --with-local=${prefix} --enable-multibyte=utf-8 \
                    --with-iconv=${prefix} --with-slib=${prefix}/lib/slib \
                    --enable-threads=pthreads --enable-ipv6

test.run            yes

destroot.target     slibcat-in-place install-pkg install-doc

universal_variant   no

variant euc_jp conflicts sjis no_multibyte { configure.args-delete --enable-multibyte=utf-8
                    configure.args-append --enable-multibyte=euc-jp }
variant sjis conflicts euc_jp no_multibyte { configure.args-delete --enable-multibyte=utf-8
                    configure.args-append --enable-multibyte=sjis }
variant no_multibyte conflicts euc_jp sjis { configure.args-delete --enable-multibyte=utf-8
                        configure.args-append --enable-multibyte=no }
variant no_iconv  { depends_lib-delete port:libiconv
                    configure.args-delete --with-iconv=${prefix} }
variant no_gdbm   { depends_lib-delete port:gdbm }
variant no_slib   { depends_lib-delete port:slib
                    configure.args-delete --with-slib=${prefix}/lib/slib }
variant no_threads   {  configure.args-delete --enable-threads=pthreads }
variant no_ipv6 {   configure.args-delete --enable-ipv6 }

